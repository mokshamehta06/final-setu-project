<link rel="stylesheet" href="/css/dashboard-variables.css">

<div class="support-container">
  <div class="support-header">
    <h1>Customer Support</h1>
    <p>We're here to help you with any questions or concerns you may have. Choose the best way to get in touch with us.</p>
  </div>

  <div class="support-options">
    <div class="support-card">
      <i class="fas fa-comments"></i>
      <h3>Live Chat</h3>
      <p>Get instant help from our support team through real-time chat.</p>
      <button class="btn btn-primary" id="startChatBtn">
        <i class="fas fa-comments"></i> Start Chat
      </button>
    </div>

    <div class="support-card">
      <i class="fas fa-ticket-alt"></i>
      <h3>Support Tickets</h3>
      <p>Create a ticket for complex issues that need detailed attention.</p>
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ticketModal">
        <i class="fas fa-ticket-alt"></i> Create Ticket
      </button>
    </div>
  </div>

  <div class="faq-section">
    <h2>Frequently Asked Questions</h2>
    <div class="accordion" id="faqAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
            How do I track my order?
          </button>
        </h2>
        <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">
            You can track your order by going to "My Orders" section in your dashboard and clicking on the "View Details" button for the specific order.
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
            What is the return policy?
          </button>
        </h2>
        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">
            Most items can be returned within 7 days of delivery. Please note that some seized items may have special return policies. Check the product details for specific information.
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
            How do I cancel an order?
          </button>
        </h2>
        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
          <div class="accordion-body">
            You can cancel an order if it's still in "Pending" status. Go to "My Orders", find the order you want to cancel, click "View Details", and then click the "Cancel Order" button.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Ticket Modal -->
<div class="modal fade" id="ticketModal" tabindex="-1" aria-labelledby="ticketModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="ticketModalLabel">Create Support Ticket</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="supportTicketForm">
          <div class="mb-3">
            <label for="ticketSubject" class="form-label">Subject</label>
            <input type="text" class="form-control" id="ticketSubject" required>
          </div>
          <div class="mb-3">
            <label for="ticketCategory" class="form-label">Category</label>
            <select class="form-select" id="ticketCategory" required>
              <option value="">Select a category</option>
              <option value="order">Order Issue</option>
              <option value="payment">Payment Issue</option>
              <option value="product">Product Inquiry</option>
              <option value="return">Return/Refund</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="ticketMessage" class="form-label">Message</label>
            <textarea class="form-control" id="ticketMessage" rows="5" required></textarea>
          </div>
          <div class="mb-3">
            <label for="ticketAttachment" class="form-label">Attachment (optional)</label>
            <input type="file" class="form-control" id="ticketAttachment">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="submitTicketBtn">Submit Ticket</button>
      </div>
    </div>
  </div>
</div>

<!-- Chat Widget -->
<div id="chatWidget" class="chat-widget">
  <div class="chat-header">
    <h6>Customer Support</h6>
    <button id="closeChatBtn" class="btn-close btn-close-white"></button>
  </div>
  <div class="chat-body" id="chatMessages">
    <div class="message support">
      <div class="message-content">
        Hello! How can I help you today?
      </div>
      <div class="message-time">Just now</div>
    </div>
  </div>
  <div class="chat-footer">
    <input type="text" id="chatInput" class="form-control" placeholder="Type your message...">
    <button id="sendMessageBtn" class="btn btn-primary">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Chat widget functionality
  const chatWidget = document.getElementById('chatWidget');
  const startChatBtn = document.getElementById('startChatBtn');
  const closeChatBtn = document.getElementById('closeChatBtn');
  const chatInput = document.getElementById('chatInput');
  const sendMessageBtn = document.getElementById('sendMessageBtn');
  const chatMessages = document.getElementById('chatMessages');

  startChatBtn.addEventListener('click', function() {
    chatWidget.style.display = 'flex';
  });

  closeChatBtn.addEventListener('click', function() {
    chatWidget.style.display = 'none';
  });

  function sendMessage() {
    const message = chatInput.value.trim();
    if (message) {
      // Add user message
      const userMessage = document.createElement('div');
      userMessage.className = 'message user';
      userMessage.innerHTML = `
        <div class="message-content">${message}</div>
        <div class="message-time">Just now</div>
      `;
      chatMessages.appendChild(userMessage);

      // Clear input
      chatInput.value = '';

      // Scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // Simulate support response
      setTimeout(() => {
        const supportMessage = document.createElement('div');
        supportMessage.className = 'message support';
        supportMessage.innerHTML = `
          <div class="message-content">Thank you for your message. Our support team will get back to you shortly.</div>
          <div class="message-time">Just now</div>
        `;
        chatMessages.appendChild(supportMessage);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1000);
    }
  }

  sendMessageBtn.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });

  // Ticket form submission
  const submitTicketBtn = document.getElementById('submitTicketBtn');
  submitTicketBtn.addEventListener('click', function() {
    // Add your ticket submission logic here
    alert('Ticket submitted successfully!');
    const modal = bootstrap.Modal.getInstance(document.getElementById('ticketModal'));
    modal.hide();
  });
});
</script>

<style>
  .support-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .support-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .support-header h1 {
    color: var(--primary-700);
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .support-header p {
    color: var(--neutral-600);
    max-width: 700px;
    margin: 0 auto;
    font-size: 1.1rem;
  }

  .support-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
  }

  .support-card {
    background-color: white;
    border-radius: var(--card-radius);
    padding: 2rem;
    text-align: center;
    box-shadow: var(--card-shadow);
    transition: var(--transition);
  }

  .support-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--hover-shadow);
  }

  .support-card i {
    font-size: 2.5rem;
    color: var(--primary-600);
    margin-bottom: 1rem;
    display: block;
  }

  .support-card h3 {
    color: var(--neutral-800);
    margin-bottom: 1rem;
    font-size: 1.5rem;
  }

  .support-card p {
    color: var(--neutral-600);
    margin-bottom: 1.5rem;
  }

  .faq-section {
    background-color: white;
    border-radius: var(--card-radius);
    padding: 2rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 3rem;
  }

  .faq-section h2 {
    color: var(--primary-700);
    margin-bottom: 1.5rem;
    text-align: center;
  }

  .accordion-item {
    border-color: var(--neutral-200);
    margin-bottom: 1rem;
    border-radius: 0.5rem !important;
    overflow: hidden;
  }

  .accordion-button {
    font-weight: 600;
    color: var(--neutral-700);
    background-color: var(--neutral-50);
    box-shadow: none !important;
  }

  .accordion-button:not(.collapsed) {
    color: var(--primary-700);
    background-color: var(--primary-50);
  }

  .accordion-body {
    color: var(--neutral-600);
    padding: 1.5rem;
  }

  .chat-widget {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 350px;
    height: 450px;
    background-color: white;
    border-radius: var(--card-radius);
    box-shadow: var(--hover-shadow);
    display: none;
    flex-direction: column;
    overflow: hidden;
    z-index: 1000;
  }

  .chat-header {
    background-color: var(--primary-600);
    color: white;
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .chat-header h6 {
    margin: 0;
    font-weight: 600;
  }

  .chat-body {
    flex: 1;
    padding: 1rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .message {
    max-width: 80%;
    display: flex;
    flex-direction: column;
  }

  .message.user {
    align-self: flex-end;
  }

  .message.support {
    align-self: flex-start;
  }

  .message-content {
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    font-size: 0.9rem;
  }

  .message.user .message-content {
    background-color: var(--primary-600);
    color: white;
    border-bottom-right-radius: 0.25rem;
  }

  .message.support .message-content {
    background-color: var(--neutral-100);
    color: var(--neutral-800);
    border-bottom-left-radius: 0.25rem;
  }

  .message-time {
    font-size: 0.7rem;
    color: var(--neutral-500);
    margin-top: 0.25rem;
    align-self: flex-end;
  }

  .message.support .message-time {
    align-self: flex-start;
  }

  .chat-footer {
    display: flex;
    padding: 0.75rem;
    border-top: 1px solid var(--neutral-200);
    background-color: white;
  }

  .chat-footer input {
    flex: 1;
    margin-right: 0.5rem;
    border-radius: 20px;
  }

  .chat-footer button {
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
  }

  .btn-primary {
    background-color: var(--primary-600);
    border-color: var(--primary-600);
  }

  .btn-primary:hover {
    background-color: var(--primary-700);
    border-color: var(--primary-700);
  }

  @media (max-width: 768px) {
    .support-container {
      padding: 1rem;
    }

    .chat-widget {
      width: 100%;
      height: 100%;
      bottom: 0;
      right: 0;
      border-radius: 0;
    }
  }
</style>

<%- include('../partials/footer') %>

